"use strict";(()=>{var e={};e.id=932,e.ids=[932],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},70540:(e,r,t)=>{let s;t.r(r),t.d(r,{originalPathname:()=>E,patchFetch:()=>S,requestAsyncStorage:()=>f,routeModule:()=>v,serverHooks:()=>R,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{POST:()=>x});var n=t(67092),a=t(25932),i=t(94147),u=t(77856),l=t(53524),p=t(43604),c=t.n(p),d=t(55760),m=t.n(d);try{s=new l.PrismaClient}catch(e){console.error("Failed to create Prisma Client:",e)}let g=process.env.JWT_SECRET;async function x(e){console.log("Auth endpoint reached"),console.log("Environment variables:",{DATABASE_URL:process.env.DATABASE_URL?"Set":"Not set",JWT_SECRET:process.env.JWT_SECRET?"Set":"Not set"});try{if(!g)return console.error("JWT_SECRET is not defined"),u.NextResponse.json({message:"Server configuration error"},{status:500});if(!s)return console.error("Database connection not established"),u.NextResponse.json({message:"Database connection error"},{status:500});let{email:r,password:t}=await e.json();console.log("Login attempt for email:",r);let o=await s.user.findUnique({where:{email:r}});if(console.log("User found:",o?"Yes":"No"),!o)return u.NextResponse.json({message:"Invalid credentials"},{status:401});let n=await c().compare(t,o.password);if(console.log("Password valid:",n),!n)return u.NextResponse.json({message:"Invalid credentials"},{status:401});let a=m().sign({id:o.id,email:o.email,role:o.role},g,{expiresIn:"1h"});return console.log("Login successful for user:",r),u.NextResponse.json({token:a,user:{id:o.id,name:o.name,email:o.email,role:o.role}})}catch(e){if(console.error("Login error:",e),e instanceof Error)return u.NextResponse.json({message:`Server error: ${e.message}`},{status:500});return u.NextResponse.json({message:"Unknown server error"},{status:500})}}let v=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/route",pathname:"/api/auth",filename:"route",bundlePath:"app/api/auth/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\doctorcelweb\\doctorcelweb\\src\\app\\api\\auth\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:R}=v,E="/api/auth/route";function S(){return(0,i.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:h})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[424,965,760,604],()=>t(70540));module.exports=s})();