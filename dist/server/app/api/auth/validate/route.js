"use strict";(()=>{var e={};e.id=548,e.ids=[548],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},56483:(e,t,o)=>{o.r(t),o.d(t,{originalPathname:()=>R,patchFetch:()=>T,requestAsyncStorage:()=>g,routeModule:()=>f,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var r={};o.r(r),o.d(r,{GET:()=>m,dynamic:()=>p});var s=o(67092),n=o(25932),a=o(94147),i=o(77856),u=o(53524),l=o(55760),d=o.n(l);let p="force-dynamic",c=new u.PrismaClient,v=process.env.JWT_SECRET;async function m(e){console.log("Validate endpoint reached"),console.log("Environment variables:",{DATABASE_URL:process.env.DATABASE_URL?"Set":"Not set",JWT_SECRET:process.env.JWT_SECRET?"Set":"Not set"});try{if(!v)return console.error("JWT_SECRET is not defined"),i.NextResponse.json({message:"Server configuration error"},{status:500});let t=e.headers.get("Authorization");if(!t)return console.log("No Authorization header provided"),i.NextResponse.json({message:"No token provided"},{status:401});let o=t.split(" ")[1];if(!o)return console.log("Invalid token format in Authorization header"),i.NextResponse.json({message:"Invalid token format"},{status:401});console.log("Validating token");let r=d().verify(o,v);console.log("Token decoded:",r);let s=await c.user.findUnique({where:{id:r.id},select:{id:!0,name:!0,email:!0,role:!0}});if(!s)return console.log("User not found for id:",r.id),i.NextResponse.json({message:"User not found"},{status:404});return console.log("Token validated successfully for user:",s.email),i.NextResponse.json(s)}catch(e){if(console.error("Token validation error:",e),e instanceof d().JsonWebTokenError)return i.NextResponse.json({message:"Invalid token"},{status:401});return i.NextResponse.json({message:"Internal server error"},{status:500})}finally{await c.$disconnect()}}let f=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/validate/route",pathname:"/api/auth/validate",filename:"route",bundlePath:"app/api/auth/validate/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Desktop\\doctorcelweb\\doctorcelweb\\src\\app\\api\\auth\\validate\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:g,staticGenerationAsyncStorage:h,serverHooks:x}=f,R="/api/auth/validate/route";function T(){return(0,a.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),r=t.X(0,[424,965,760],()=>o(56483));module.exports=r})();