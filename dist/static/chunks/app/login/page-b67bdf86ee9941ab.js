(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{12537:function(e,t,r){Promise.resolve().then(r.bind(r,53266))},16463:function(e,t,r){"use strict";var o=r(71169);r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})},53266:function(e,t,r){"use strict";r.d(t,{Login:function(){return l}});var o=r(57437),n=r(2265),a=r(16463),i=r(39630),s=r(38688),u=r.n(s);let l=()=>{let[e,t]=(0,n.useState)(""),[r,s]=(0,n.useState)(""),[l,c]=(0,n.useState)(""),h=(0,a.useRouter)(),{login:d}=(0,i.E)(),f=async t=>{t.preventDefault(),c("");try{await d(e,r),console.log("Login successful, redirecting to dashboard..."),h.push("/dashboard")}catch(e){console.error("Login error:",e),e instanceof Error?c(e.message):c("Error en el inicio de sesi\xf3n")}};return(0,o.jsxs)("form",{className:u().loginForm,onSubmit:f,children:[(0,o.jsx)("h2",{children:"Iniciar Sesi\xf3n"}),l&&(0,o.jsx)("p",{className:u().error,children:l}),(0,o.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"Email",required:!0}),(0,o.jsx)("input",{type:"password",value:r,onChange:e=>s(e.target.value),placeholder:"Contrase\xf1a",required:!0}),(0,o.jsx)("button",{type:"submit",children:"Iniciar Sesi\xf3n"})]})}},39630:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return s},E:function(){return u}});var o=r(57437),n=r(2265),a=r(16463);let i=(0,n.createContext)(void 0),s=e=>{let{children:t}=e,[r,s]=(0,n.useState)(null),u=(0,a.useRouter)();(0,n.useEffect)(()=>{let e=localStorage.getItem("token");e&&l(e)},[]);let l=async e=>{try{let t=await fetch("/api/auth/validate",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();s(e)}else localStorage.removeItem("token")}catch(e){console.error("Error validating token:",e),localStorage.removeItem("token")}},c=async(e,t)=>{try{let r=await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(r.ok){let e=await r.json();return localStorage.setItem("token",e.token),s(e.user),console.log("User logged in:",e.user),e.user}throw Error("Login failed")}catch(e){throw console.error("Login error:",e),e}};return(0,o.jsx)(i.Provider,{value:{user:r,login:c,logout:()=>{localStorage.removeItem("token"),s(null),u.push("/login")}},children:t})},u=()=>{let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuthContext must be used within an AuthProvider");return e}},38688:function(){}},function(e){e.O(0,[468,971,23,744],function(){return e(e.s=12537)}),_N_E=e.O()}]);