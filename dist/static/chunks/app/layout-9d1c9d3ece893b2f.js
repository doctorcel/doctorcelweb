(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{81716:function(e,t,o){Promise.resolve().then(o.bind(o,39630)),Promise.resolve().then(o.t.bind(o,15204,23))},16463:function(e,t,o){"use strict";var r=o(71169);o.o(r,"useRouter")&&o.d(t,{useRouter:function(){return r.useRouter}})},39630:function(e,t,o){"use strict";o.d(t,{AuthProvider:function(){return i},E:function(){return l}});var r=o(57437),n=o(2265),u=o(16463);let a=(0,n.createContext)(void 0),i=e=>{let{children:t}=e,[o,i]=(0,n.useState)(null),l=(0,u.useRouter)();(0,n.useEffect)(()=>{let e=localStorage.getItem("token");e&&s(e)},[]);let s=async e=>{try{let t=await fetch("/api/auth/validate",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();i(e)}else localStorage.removeItem("token")}catch(e){console.error("Error validating token:",e),localStorage.removeItem("token")}},c=async(e,t)=>{try{let o=await fetch("/api/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(o.ok){let e=await o.json();return localStorage.setItem("token",e.token),i(e.user),console.log("User logged in:",e.user),e.user}throw Error("Login failed")}catch(e){throw console.error("Login error:",e),e}};return(0,r.jsx)(a.Provider,{value:{user:o,login:c,logout:()=>{localStorage.removeItem("token"),i(null),l.push("/login")}},children:t})},l=()=>{let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuthContext must be used within an AuthProvider");return e}},15204:function(){}},function(e){e.O(0,[846,971,23,744],function(){return e(e.s=81716)}),_N_E=e.O()}]);