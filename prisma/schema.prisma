generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Warehouse {
  id           Int           @id @default(autoincrement())
  name         String
  description  String?
  articles     Article[]
  invoices     Invoice[]
  techServices TechService[]
}

model Article {
  id            Int           @id @default(autoincrement())
  name          String
  description   String
  price         Float
  categoryId    Int
  camera        String?
  createdAt     DateTime      @default(now())
  price12Months Float?
  price16Months Float?
  price4Months  Float?
  price8Months  Float?
  processor     String?
  ram           String?
  storage       String?
  updatedAt     DateTime      @updatedAt
  imageUrl1     String?
  imageUrl2     String?
  imageUrl3     String?
  imageUrl4     String?
  warehouseId   Int
  category      Category      @relation(fields: [categoryId], references: [id])
  warehouse     Warehouse     @relation(fields: [warehouseId], references: [id])
  InvoiceItem   InvoiceItem[]
}

model Category {
  id       Int       @id @default(autoincrement())
  name     String
  articles Article[]
}

model Order {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  total     Float
  status    String
  clientId  Int
  client    Client   @relation(fields: [clientId], references: [id])
}

model TechService {
  id           Int       @id @default(autoincrement())
  createdAt    DateTime  @default(now())
  description  String
  status       String
  deviceType   String
  serialNumber String?
  clientId     Int
  technicianId Int
  warehouseId  Int
  client       Client    @relation(fields: [clientId], references: [id])
  technician   User      @relation(fields: [technicianId], references: [id])
  warehouse    Warehouse @relation(fields: [warehouseId], references: [id])
}

model Invoice {
  id            Int           @id @default(autoincrement())
  number        String        @unique
  date          DateTime      @default(now())
  total         Float
  clientId      Int
  companyInfoId Int
  clientName    String
  clientAddress String?
  clientPhone   String?
  clientEmail   String?
  clientTaxId   String?
  warehouseId   Int
  client        Client        @relation(fields: [clientId], references: [id])
  companyInfo   CompanyInfo   @relation(fields: [companyInfoId], references: [id])
  warehouse     Warehouse     @relation(fields: [warehouseId], references: [id])
  items         InvoiceItem[]
}

model InvoiceItem {
  id        Int     @id @default(autoincrement())
  invoiceId Int
  articleId Int
  quantity  Int
  price     Float
  subtotal  Float
  article   Article @relation(fields: [articleId], references: [id])
  invoice   Invoice @relation(fields: [invoiceId], references: [id])
}

model Client {
  id           Int           @id @default(autoincrement())
  name         String
  email        String?
  phone        String?
  address      String?
  taxId        String?
  invoices     Invoice[]
  orders       Order[]
  techServices TechService[]
}

model User {
  id           Int           @id @default(autoincrement())
  name         String
  email        String        @unique
  password     String
  role         Role
  techServices TechService[]
}

model CompanyInfo {
  id       Int       @id @default(autoincrement())
  name     String
  address  String
  phone    String
  email    String
  taxId    String
  invoices Invoice[]
}

enum Role {
  ADMIN
  SELLER
  TECHNICIAN
}
